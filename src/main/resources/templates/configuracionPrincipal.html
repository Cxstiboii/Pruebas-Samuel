<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Principal</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" th:href="@{/css/configuracionPrincipal.css}">

    <!--Fuente Inter-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Iconos Material -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
</head>


<body>
    <nav class = "mobile-navbar">
        <a th:href=""><span class="material-symbols-outlined ">menu</span></a>
        <p >Configuración de Perfil</p>
        <a href="javascript:void(0);" onclick="document.getElementById('formActualizar').submit();">Guardar</a>
    </nav>

    <!--Menu lateral mobile-->
    <section id ="menu" class = "mobile-menu">
        <div class = "menu-overlay"></div>
        <div class = "menu-content">
            <div class = "menu-header">
                <a href="#" class="menu-close">
                    <span class="material-symbols-outlined">close</span>
                </a>
                <h3>OinkCoin</h3>
            </div>

            <div class="menu-items">
            <a th:href="@{dashboardPrincipal}" class = "nav-item ">
                    <span class = "material-symbols-outlined">dashboard</span>
                    <span>Dashboard</span>
                </a>
                    <a href="#" class="nav-item">
                <span class="material-symbols-outlined">add_circle</span>
                <span>Añadir ingreso</span>
            </a>
            <a href="#" class="nav-item">
                <span class="material-symbols-outlined">do_not_disturb_on</span>
                <span>Añadir gasto</span>
            </a>
        </div>

        <div class = "nav-footer">
                <a href="" class = "nav-item">
                    <span class="material-symbols-outlined">settings</span>
                    <span>Configuración</span>
                </a>
                <a href="#" class="nav-item active">
                    <span class="material-symbols-outlined">logout</span>
                    <span>Cerrar Sesión</span>
                </a>
            </div>
        </div>
    </section>

    <!--Nav para Desktop-->
    <div class = "desktop-layout">
        <nav class = "desktop-navbar">
            <div class = "nav-header">
                <div class = "nav-logo">
                    <span class="material-symbols-outlined">savings</span>
                    <p>OinkCoin</p>
                </div>
            </div>

            <!--Menu lateral para dekstop-->
            <div class = "nav-menu">
                <a href="@{dashboardPrincipal}" class = "nav-item ">
                    <span class = "material-symbols-outlined">dashboard</span>
                    <span>Dashboard</span>
                </a>
                    <a href="#" class="nav-item">
                <span class="material-symbols-outlined">add_circle</span>
                <span>Añadir ingreso</span>
            </a>
            <a href="#" class="nav-item">
                <span class="material-symbols-outlined">do_not_disturb_on</span>
                <span>Añadir gasto</span>
            </a>
            </div>

            <div class = "nav-footer">
                <a href="@{/configuracion}" class = "nav-item active">
                    <span class="material-symbols-outlined">settings</span>
                    <span>Configuración</span>
                </a>
                <a href="#" class="nav-item">
                    <span class="material-symbols-outlined">logout</span>
                    <span>Cerrar Sesión</span>
                </a>
            </div>
        </nav>
    </div>

    <header>
        <a href=""><img src="" alt=""></a>
    </header>

    <main class = "main-content">

        <!-- Mostrar mensajes -->
        <div th:if="${mensaje}" 
                th:class="${tipoMensaje == 'success' ? 'alert alert-success' : 'alert alert-error'}" 
                th:text="${mensaje}">
        </div>
        <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

        <!-- Personal info-->
        <!-- Formulario de actualización de perfil -->
        <form id="formActualizar" th:action="@{/configuracion/actualizar}" method="post">
            <!-- Personal info -->
            <section>
                <h5>INFORMACIÓN PERSONAL</h5>
                <article class="personal-info">
                    <div>
                        <span>Nombre de usuario</span>
                        <input type="text" 
                                name="nombreUsuario" 
                                th:value="${nombreUsuario}">
                    </div>
                    <div>
                        <span>Correo electrónico</span>
                        <p th:text="${emailUsuario}">email@example.com</p>
                        <small style="color: #8D99AE; font-size: 0.75rem;">El correo no se puede modificar</small>
                    </div>
                    <div>
                        <p>Cambiar contraseña</p>
                        <a href="#cambiarPassword"><span class="material-symbols-outlined">arrow_forward_ios</span></a>
                    </div>
                </article>
            </section>
        </form>

        <!-- Sección de eliminar cuenta -->
        <section>
            <h5>CUENTA</h5>
            <article class="personal-info">
                <section class="logout-section">
                    <button type="button" 
                            class="delete-button"
                            onclick="confirmarEliminacion()">
                        Eliminar Cuenta
                    </button>
                </section>
            </article>
        </section>


        <!-- Modal de confirmación (oculto) -->
        <div id="modalConfirmacion" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 9999; justify-content: center; align-items: center;">
            <div style="background: #193320; padding: 2rem; border-radius: 1rem; max-width: 400px; text-align: center; border: 1px solid #32673f;">
                <span class="material-symbols-outlined" style="font-size: 3rem; color: #ef4444;">warning</span>
                <h3 style="color: white; margin: 1rem 0;">¿Estás seguro?</h3>
                <p style="color: #A0AEC0; margin-bottom: 1.5rem;">Esta acción no se puede deshacer. Se eliminarán todos tus datos de forma permanente.</p>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button onclick="cerrarModal()" 
                            style="padding: 0.75rem 1.5rem; border-radius: 0.75rem; border: 1px solid #32673f; background: transparent; color: white; cursor: pointer;">
                        Cancelar
                    </button>
                    <form th:action="@{/configuracion/eliminar-cuenta}" method="post" style="display: inline;">
                        <button type="submit" 
                                class="delete-button"
                                style="margin: 0;">
                            Sí, eliminar mi cuenta
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </main>


    <script>
        function confirmarEliminacion() {
            document.getElementById('modalConfirmacion').style.display = 'flex';
        }

        function cerrarModal() {
            document.getElementById('modalConfirmacion').style.display = 'none';
        }

        // Auto-ocultar alertas después de 5 segundos
        setTimeout(() => {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(alert => {
                alert.style.transition = 'all 0.3s ease-out';
                alert.style.opacity = '0';
                alert.style.transform = 'translateY(-10px)';
                setTimeout(() => alert.remove(), 300);
            });
        }, 5000);

        // Cerrar modal al hacer clic fuera
        document.getElementById('modalConfirmacion')?.addEventListener('click', function(e) {
            if (e.target === this) {
                cerrarModal();
            }
        });
    </script>
</body>
</html>